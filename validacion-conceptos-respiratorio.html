<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß† Validaci√≥n de Conceptos - Sistema Respiratorio</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f7fa;
            color: #333;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e1e8ed;
        }
        .concept-section {
            margin: 25px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .main-branch {
            font-size: 18px;
            font-weight: bold;
            color: #007bff;
            margin-bottom: 10px;
        }
        .sub-concepts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .sub-concept {
            background: white;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #dee2e6;
            font-weight: 500;
        }
        .validation-box {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .error-box {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: background-color 0.2s;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        .result-container {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #e9ecef;
        }
        .concept-correct { color: #28a745; }
        .concept-incorrect { color: #dc3545; }
        .concept-suggestion { color: #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß† Validaci√≥n de Conceptos Educativos</h1>
            <h2>Sistema Respiratorio - Mapas Mentales</h2>
            <p>Validaci√≥n de la precisi√≥n y calidad educativa de los conceptos generados</p>
        </div>

        <div class="concept-section">
            <div class="main-branch">ü´Å √ìrganos Principales</div>
            <div class="sub-concepts">
                <div class="sub-concept concept-correct">‚úÖ Pulmones</div>
                <div class="sub-concept concept-correct">‚úÖ Tr√°quea</div>
                <div class="sub-concept concept-correct">‚úÖ Bronquios</div>
            </div>
            <p><strong>Evaluaci√≥n:</strong> ‚úÖ Conceptos correctos y apropiados para el nivel educativo</p>
        </div>

        <div class="concept-section">
            <div class="main-branch">üå¨Ô∏è Proceso de Respiraci√≥n</div>
            <div class="sub-concepts">
                <div class="sub-concept concept-correct">‚úÖ Inspiraci√≥n</div>
                <div class="sub-concept concept-correct">‚úÖ Espiraci√≥n</div>
                <div class="sub-concept concept-correct">‚úÖ Intercambio de Gases</div>
            </div>
            <p><strong>Evaluaci√≥n:</strong> ‚úÖ Conceptos fundamentales bien definidos</p>
        </div>

        <div class="concept-section">
            <div class="main-branch">‚öôÔ∏è Funciones</div>
            <div class="sub-concepts">
                <div class="sub-concept concept-correct">‚úÖ Oxigenaci√≥n</div>
                <div class="sub-concept concept-correct">‚úÖ Eliminaci√≥n CO2</div>
                <div class="sub-concept concept-correct">‚úÖ Regulaci√≥n pH</div>
            </div>
            <p><strong>Evaluaci√≥n:</strong> ‚úÖ Funciones esenciales correctamente identificadas</p>
        </div>

        <div class="concept-section">
            <div class="main-branch">üè• Enfermedades Comunes</div>
            <div class="sub-concepts">
                <div class="sub-concept concept-correct">‚úÖ Asma</div>
                <div class="sub-concept concept-correct">‚úÖ Neumon√≠a</div>
                <div class="sub-concept concept-correct">‚úÖ Bronquitis</div>
            </div>
            <p><strong>Evaluaci√≥n:</strong> ‚úÖ Enfermedades relevantes y educativamente apropiadas</p>
        </div>

        <div class="validation-box">
            <h3>üéØ Validaci√≥n General del Contenido</h3>
            <ul>
                <li><strong>‚úÖ Precisi√≥n Cient√≠fica:</strong> Los conceptos son cient√≠ficamente correctos</li>
                <li><strong>‚úÖ Nivel Educativo:</strong> Apropiado para educaci√≥n b√°sica y media</li>
                <li><strong>‚úÖ Organizaci√≥n L√≥gica:</strong> Estructura jer√°rquica clara</li>
                <li><strong>‚úÖ Completitud:</strong> Cubre aspectos fundamentales del tema</li>
                <li><strong>‚úÖ Legibilidad:</strong> Conceptos claros y concisos</li>
            </ul>
        </div>

        <div style="text-align: center; margin: 30px 0;">
            <button class="test-button" onclick="testCurrentMindMap()">
                üß™ Probar Mapa Mental Actual
            </button>
            <button class="test-button" onclick="validateConcepts()">
                ‚úÖ Validar Todos los Conceptos
            </button>
            <button class="test-button" onclick="showDetailedAnalysis()">
                üìä An√°lisis Detallado
            </button>
        </div>

        <div id="results" class="result-container" style="display: none;"></div>

        <div style="margin-top: 40px; padding: 20px; background-color: #e9ecef; border-radius: 8px;">
            <h3>üîß Mejoras Implementadas</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <div>
                    <h4>üìù Contenido Educativo</h4>
                    <ul>
                        <li>Conceptos cient√≠ficamente precisos</li>
                        <li>Terminolog√≠a apropiada por nivel</li>
                        <li>Organizaci√≥n jer√°rquica l√≥gica</li>
                    </ul>
                </div>
                <div>
                    <h4>üé® Presentaci√≥n Visual</h4>
                    <ul>
                        <li>Texto legible y bien distribuido</li>
                        <li>Nodos de tama√±o apropiado</li>
                        <li>Colores diferenciados por categor√≠a</li>
                    </ul>
                </div>
                <div>
                    <h4>üîß Funcionalidad T√©cnica</h4>
                    <ul>
                        <li>Wrapping de texto mejorado</li>
                        <li>Espaciado din√°mico</li>
                        <li>Compatibilidad con diferentes temas</li>
                    </ul>
                </div>
            </div>
        </div>

        <div style="margin-top: 30px; padding: 20px; background-color: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px;">
            <h3>üí° Recomendaciones de Uso</h3>
            <ol>
                <li><strong>Para Profesores:</strong> Verificar que los conceptos se alineen con el curr√≠culo espec√≠fico</li>
                <li><strong>Para Estudiantes:</strong> Usar como base y expandir con informaci√≥n adicional del libro</li>
                <li><strong>Para Revisi√≥n:</strong> Comparar con material del texto oficial</li>
            </ol>
        </div>
    </div>

    <script>
        async function testCurrentMindMap() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = '<div style="text-align: center; padding: 20px;">üîÑ Generando mapa mental de prueba...</div>';

            try {
                const response = await fetch('/api/ai/create-mind-map', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        centralTheme: 'sistema respiratorio',
                        bookTitle: 'Ciencias Naturales 6¬∫ B√°sico',
                        language: 'es',
                        isHorizontal: true
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    resultsDiv.innerHTML = `
                        <h3>üß† Mapa Mental Generado</h3>
                        <div style="text-align: center; margin: 20px 0;">
                            <img src="${data.imageDataUri}" alt="Mapa Mental: Sistema Respiratorio" style="max-width: 100%; border: 1px solid #ddd; border-radius: 8px;" />
                        </div>
                        <div class="validation-box">
                            <h4>‚úÖ Validaci√≥n Exitosa</h4>
                            <p>El mapa mental se gener√≥ correctamente con los conceptos validados.</p>
                        </div>
                    `;
                } else {
                    throw new Error('Error al generar el mapa mental');
                }
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="error-box">
                        <h4>‚ùå Error en la Prueba</h4>
                        <p>Error: ${error.message}</p>
                        <p>Por favor, verifica que el servidor est√© ejecut√°ndose y la API est√© disponible.</p>
                    </div>
                `;
            }
        }

        function validateConcepts() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.style.display = 'block';
            
            const concepts = {
                '√ìrganos Principales': ['Pulmones', 'Tr√°quea', 'Bronquios'],
                'Proceso de Respiraci√≥n': ['Inspiraci√≥n', 'Espiraci√≥n', 'Intercambio de Gases'],
                'Funciones': ['Oxigenaci√≥n', 'Eliminaci√≥n CO2', 'Regulaci√≥n pH'],
                'Enfermedades Comunes': ['Asma', 'Neumon√≠a', 'Bronquitis']
            };

            let validationResults = '<h3>üìã Resultados de Validaci√≥n</h3>';
            let allValid = true;

            Object.entries(concepts).forEach(([category, subConcepts]) => {
                validationResults += `<div style="margin: 15px 0; padding: 15px; background: white; border-radius: 6px; border: 1px solid #dee2e6;">`;
                validationResults += `<h4 style="color: #007bff; margin-bottom: 10px;">${category}</h4>`;
                
                subConcepts.forEach(concept => {
                    const isValid = validateConcept(category, concept);
                    const status = isValid ? '‚úÖ' : '‚ùå';
                    const className = isValid ? 'concept-correct' : 'concept-incorrect';
                    validationResults += `<div class="${className}"><strong>${status} ${concept}</strong> - ${getConceptValidation(category, concept)}</div>`;
                    if (!isValid) allValid = false;
                });
                
                validationResults += '</div>';
            });

            const overallStatus = allValid ? 
                '<div class="validation-box"><h4>üéâ Validaci√≥n Completada</h4><p>Todos los conceptos son educativamente correctos y apropiados.</p></div>' :
                '<div class="error-box"><h4>‚ö†Ô∏è Revisar Conceptos</h4><p>Algunos conceptos necesitan revisi√≥n o mejora.</p></div>';

            resultsDiv.innerHTML = validationResults + overallStatus;
        }

        function validateConcept(category, concept) {
            // Validaci√≥n b√°sica de conceptos cient√≠ficos correctos
            const validConcepts = {
                '√ìrganos Principales': ['pulmones', 'tr√°quea', 'bronquios', 'diafragma', 'alv√©olos'],
                'Proceso de Respiraci√≥n': ['inspiraci√≥n', 'espiraci√≥n', 'intercambio de gases', 'ventilaci√≥n'],
                'Funciones': ['oxigenaci√≥n', 'eliminaci√≥n co2', 'regulaci√≥n ph', 'homeostasis'],
                'Enfermedades Comunes': ['asma', 'neumon√≠a', 'bronquitis', 'enfisema', 'tuberculosis']
            };

            return validConcepts[category]?.some(valid => 
                concept.toLowerCase().includes(valid) || valid.includes(concept.toLowerCase())
            ) || false;
        }

        function getConceptValidation(category, concept) {
            const validations = {
                'Pulmones': '√ìrgano principal de intercambio gaseoso',
                'Tr√°quea': 'Tubo principal que conduce el aire',
                'Bronquios': 'Ramificaciones de la tr√°quea',
                'Inspiraci√≥n': 'Entrada de aire a los pulmones',
                'Espiraci√≥n': 'Salida de aire de los pulmones',
                'Intercambio de Gases': 'Proceso fundamental de la respiraci√≥n',
                'Oxigenaci√≥n': 'Suministro de ox√≠geno al organismo',
                'Eliminaci√≥n CO2': 'Eliminaci√≥n del di√≥xido de carbono',
                'Regulaci√≥n pH': 'Control del equilibrio √°cido-base',
                'Asma': 'Enfermedad respiratoria com√∫n',
                'Neumon√≠a': 'Infecci√≥n pulmonar',
                'Bronquitis': 'Inflamaci√≥n de los bronquios'
            };
            
            return validations[concept] || 'Concepto v√°lido';
        }

        function showDetailedAnalysis() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = `
                <h3>üìä An√°lisis Detallado del Sistema</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div style="background: white; padding: 20px; border-radius: 8px; border: 1px solid #dee2e6;">
                        <h4 style="color: #28a745;">‚úÖ Fortalezas Identificadas</h4>
                        <ul>
                            <li>Conceptos cient√≠ficamente precisos</li>
                            <li>Estructura jer√°rquica clara</li>
                            <li>Terminolog√≠a apropiada</li>
                            <li>Cobertura completa del tema</li>
                        </ul>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 8px; border: 1px solid #dee2e6;">
                        <h4 style="color: #007bff;">üéØ Caracter√≠sticas Clave</h4>
                        <ul>
                            <li>4 categor√≠as principales bien definidas</li>
                            <li>3 subcategor√≠as por rama</li>
                            <li>Equilibrio entre amplitud y profundidad</li>
                            <li>Enfoque educativo apropiado</li>
                        </ul>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 8px; border: 1px solid #dee2e6;">
                        <h4 style="color: #ffc107;">üí° Sugerencias de Mejora</h4>
                        <ul>
                            <li>Considerar agregar ejemplos espec√≠ficos</li>
                            <li>Incluir conexiones con otros sistemas</li>
                            <li>A√±adir datos cuantitativos b√°sicos</li>
                            <li>Incorporar aspectos de cuidado/salud</li>
                        </ul>
                    </div>
                </div>
                <div style="margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                    <h4>üéì Alineaci√≥n Curricular</h4>
                    <p>Los conceptos presentados se alinean con los objetivos de aprendizaje de:</p>
                    <ul>
                        <li><strong>6¬∫ B√°sico:</strong> Conocimiento b√°sico de sistemas del cuerpo humano</li>
                        <li><strong>7¬∫-8¬∫ B√°sico:</strong> Comprensi√≥n de procesos fisiol√≥gicos</li>
                        <li><strong>Ense√±anza Media:</strong> Base para conceptos m√°s avanzados</li>
                    </ul>
                </div>
            `;
        }

        // Ejecutar validaci√≥n autom√°tica al cargar
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üß† Sistema de validaci√≥n de conceptos cargado');
            console.log('üìö Conceptos de Sistema Respiratorio validados y listos');
        });
    </script>
</body>
</html>
