<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Evaluaci√≥n - Estudiante</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .warning {
            background-color: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .test-button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        .test-button:hover {
            background-color: #0056b3;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            background-color: #f8f9fa;
        }
        .step {
            margin-bottom: 20px;
            padding: 15px;
            border-left: 4px solid #007bff;
            background-color: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Prueba de Funcionalidades - Evaluaci√≥n Estudiante</h1>
        
        <div class="success">
            <h3>‚úÖ Funcionalidades Implementadas</h3>
            <ul>
                <li><strong>Server Actions:</strong> Se cre√≥ evaluation-actions.ts con funciones para manejar evaluaciones</li>
                <li><strong>Estado de Evaluaci√≥n:</strong> Ahora cambia de "pendiente" a "finalizada" autom√°ticamente</li>
                <li><strong>Porcentaje de Completitud:</strong> Se muestra en el di√°logo de resultados</li>
                <li><strong>Tiempo de Respuesta:</strong> Se registra el tiempo gastado en la evaluaci√≥n</li>
                <li><strong>Persistencia de Datos:</strong> Se actualiza localStorage con los resultados</li>
            </ul>
        </div>

        <div class="info">
            <h3>üîß Pasos para Probar</h3>
            <div class="step">
                <h4>Paso 1: Login como Estudiante</h4>
                <p>Inicia sesi√≥n con un usuario estudiante en el sistema.</p>
                <button class="test-button" onclick="openApp()">Abrir Aplicaci√≥n</button>
            </div>
            
            <div class="step">
                <h4>Paso 2: Ir a Tareas</h4>
                <p>Navega a la secci√≥n de "Tareas" en el dashboard.</p>
            </div>
            
            <div class="step">
                <h4>Paso 3: Realizar Evaluaci√≥n</h4>
                <p>Busca una tarea de tipo "evaluaci√≥n" y haz clic en "Realizar Evaluaci√≥n".</p>
            </div>
            
            <div class="step">
                <h4>Paso 4: Completar Evaluaci√≥n</h4>
                <p>Responde las preguntas y termina la evaluaci√≥n.</p>
            </div>
            
            <div class="step">
                <h4>Paso 5: Verificar Resultados</h4>
                <p>Comprueba que se muestre:</p>
                <ul>
                    <li>Porcentaje de completitud</li>
                    <li>Mensaje de estado actualizado</li>
                    <li>Cambio de estado a "finalizada"</li>
                </ul>
            </div>
        </div>

        <div class="warning">
            <h3>‚ö†Ô∏è Funcionalidades Corregidas</h3>
            <ul>
                <li><strong>Error del servidor:</strong> Se solucion√≥ el error "fetchServerAction" implementando server actions correctamente</li>
                <li><strong>Estado de la tarea:</strong> Ahora se actualiza autom√°ticamente cuando el estudiante termina</li>
                <li><strong>Persistencia:</strong> Los datos se guardan correctamente en localStorage</li>
                <li><strong>Tracking de tiempo:</strong> Se registra el tiempo exacto gastado en la evaluaci√≥n</li>
            </ul>
        </div>

        <div class="info">
            <h3>üìã Pruebas Recomendadas</h3>
            <ol>
                <li>Crear una tarea de evaluaci√≥n como profesor</li>
                <li>Asignar la tarea a un estudiante</li>
                <li>Realizar la evaluaci√≥n como estudiante</li>
                <li>Verificar que el porcentaje se muestre correctamente</li>
                <li>Confirmar que el estado cambie a "finalizada"</li>
                <li>Revisar que las notificaciones se actualicen en el profesor</li>
            </ol>
        </div>

        <div class="result">
            <h3>üéâ Estado Actual</h3>
            <p><strong>Estado del Servidor:</strong> <span id="server-status">Verificando...</span></p>
            <p><strong>Funcionalidades:</strong> Implementadas y listas para probar</p>
            <button class="test-button" onclick="checkServerStatus()">Verificar Servidor</button>
        </div>
    </div>

    <script>
        function openApp() {
            window.open('/dashboard', '_blank');
        }

        async function checkServerStatus() {
            try {
                const response = await fetch('/api/health');
                const statusElement = document.getElementById('server-status');
                
                if (response.ok) {
                    statusElement.textContent = '‚úÖ Servidor funcionando correctamente';
                    statusElement.style.color = 'green';
                } else {
                    statusElement.textContent = '‚ö†Ô∏è Servidor respondiendo pero con errores';
                    statusElement.style.color = 'orange';
                }
            } catch (error) {
                const statusElement = document.getElementById('server-status');
                statusElement.textContent = '‚ùå Error de conexi√≥n';
                statusElement.style.color = 'red';
            }
        }

        // Verificar estado del servidor al cargar
        window.onload = checkServerStatus;
    </script>
</body>
</html>
